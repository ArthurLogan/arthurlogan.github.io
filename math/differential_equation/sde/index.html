
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://example.com/math/differential_equation/sde/">
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Modelling SDE - ArthurLogan</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modelling-sde" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ArthurLogan" class="md-header__button md-logo" aria-label="ArthurLogan" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ArthurLogan
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modelling SDE
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ArthurLogan" class="md-nav__button md-logo" aria-label="ArthurLogan" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    ArthurLogan
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Math
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Math" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Math
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../probability_theory/" class="md-nav__link">
        Probability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Differential Equation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../score_based_model/" class="md-nav__link">
        Scores
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-stochastic-differential-equation" class="md-nav__link">
    1 Stochastic Differential Equation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-brownian-motion" class="md-nav__link">
    2 Brownian Motion
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-existence-uniqueness" class="md-nav__link">
    3 Existence &amp; Uniqueness
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-numerical-approximation" class="md-nav__link">
    4 Numerical Approximation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-robust-model" class="md-nav__link">
    5. Robust Model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-integration-bounded-variation" class="md-nav__link">
    6. Integration &amp; Bounded Variation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-itos-formula" class="md-nav__link">
    7. Ito's Formula
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="modelling-sde">Modelling SDE</h1>
<p>考虑病毒传播的过程，尽管平均意义上可以计算出感染率，但在传播的实际过程中，感染率不会恒定不变，而是在平均感染率附近波动。因此在微观方程中，需要增加无法估计的随机部分，因此从ODE到SDE的过渡是理所当然的，在病毒传播的例子中，随机过程模型为：
<script type="math/tex; mode=display">
\frac{dX}{ds}=(\alpha+\text{“error"})X(s), X(0)=x_0
</script>
需要注意的是，任意时刻随机部分的均值应为0，从而保证整体增长率是平均意义的增长率，若随机部分的方差也为0，则SDE会退化为ODE。为了直观说明误差的随机性，以 <script type="math/tex">X(\omega, t)</script> 表示。</p>
<h3 id="1-stochastic-differential-equation">1 Stochastic Differential Equation</h3>
<p>我们直接给出随机微分方程的积分形式，再解释过程。
<script type="math/tex; mode=display">
X(t)=x_0+\int_0^tf(X(s))ds+\sigma B(t), t\ge 0\tag{1.1}
</script>
右侧的前两项和常微分方程的结果相同，第三项我们希望捕捉误差的积累部分(<em>fluctuation</em>，涨落)。我们知道由于误差部分是随机变量的累计，因而 <script type="math/tex">X(t), B(t)</script> 均是随机过程。我们将目光关注在误差积累的性质上，经过一个短时间段变化，有：
<script type="math/tex; mode=display">
X(\omega,t+h)-X(\omega,t)=\int_t^{t+h}f(X(\omega,s))ds+\sigma\left(B(\omega,t+h)-B(\omega,t)\right)\tag{1.2}
</script>
由此我们可以得到关于误差 <script type="math/tex">B(\omega, t)</script> 的三条性质：</p>
<ul>
<li><strong>初始条件</strong>：初始时刻，坐标必然处在初始位置，因此 <script type="math/tex">B(\omega, 0)=0</script>。</li>
<li><strong>零均值</strong>：平均意义上路径符合常微分方程的解，因此 <script type="math/tex">E[B(t+h)-B(t)]=0</script>。</li>
<li><strong>时间平稳</strong>：不同时刻经过相同时间段的误差增量是独立同分布的，对于 <script type="math/tex">s_1<s_2<t_1<t_2</script>，有 <script type="math/tex">B(s_2)-B(s_1)</script> 和 <script type="math/tex">B(t_2)-B(t_1)</script> 独立，<script type="math/tex">B(t+h)-B(t)</script> 只和 <script type="math/tex">h</script> 有关。</li>
</ul>
<p>时间平稳性质说明涨落过程是不包含任何可预测的纯净噪声，并且由于任意时刻前后的波动值独立同分布，显然二者可以相差很大，因此 <script type="math/tex">B(\omega, t)</script> 关于时间是不可微的。考虑是否存在随机过程满足如上的三条性质，且任意采样过程关于时间连续？答案是存在唯一的随机过程满足这些条件，它就是随机过程的两大基石之一——布朗运动。我们同样可以将SDE写成微观方程，但由于在布朗运动的条件下坐标和误差都不可微，因此微分方程实际含义同 (1.2) 式的含义相同。
<script type="math/tex; mode=display">
dX(\omega, s)=f(X(\omega,s))ds+\sigma dB(\omega, s), X(\omega,0)=x_0\tag{1.3}
</script>
</p>
<h2 id="2-brownian-motion">2 Brownian Motion</h2>
<p>我们简单介绍布朗运动的性质，关于详细的解释和推导可以参考林元烈《应用随机过程》。</p>
<ul>
<li><strong>初始条件</strong>：<script type="math/tex">P[B(0)=0]=1</script>。</li>
<li><strong>时间平稳</strong>：相同时间间隔的增量独立同分布，<script type="math/tex">B(t)-B(s)\sim N(0,|t-s|)</script>。</li>
<li><strong>联合分布</strong>：不同时刻的布朗运动坐标的联合分布服从高斯分布，均值和协方差矩阵为：</li>
</ul>
<p>
<script type="math/tex; mode=display">
\mu=\left(E[B(s_i)]\right)_i=0, \Sigma=\left(\text{Cov}(B(s_i),B(s_j))\right)_{i,j}=(\min\{s_i,s_j\})\tag{2.1}
</script>
</p>
<ul>
<li><strong>似然函数</strong>：假设在时间序列 <script type="math/tex">0, t_1,...,t_n</script> 上观察到布朗运动的值为 <script type="math/tex">x_0, x_1,...,x_n</script>，对于的似然函数为：</li>
</ul>
<p>
<script type="math/tex; mode=display">
f(x_1,...,x_n;t_1,...,t_n,x_0)=\prod_{i=1}^n\frac{1}{\sqrt{2\pi(t_i-t_{i-1})}}e^{-\frac{(x_i-x_{i-1})^2}{2(t_i-t_{i-1})}}\tag{2.2}
</script>
</p>
<ul>
<li><strong>采样模拟</strong>：布朗运动是连续时间且不可微的随机过程，通常通过离散时间采样近似模拟。</li>
</ul>
<p>
<script type="math/tex; mode=display">
B(\omega, s_i)=B(\omega,s_{i-1})+\sqrt{s_i-s_{i-1}}Z_i,Z_i\sim N(0,1)\tag{2.3}
</script>
</p>
<h2 id="3-existence-uniqueness">3 Existence &amp; Uniqueness</h2>
<p>通过Lipschitz条件同样能保证随机微分方程解的存在和唯一性。</p>
<h2 id="4-numerical-approximation">4 Numerical Approximation</h2>
<p>和常微分方程类似，我们同样通过前向欧拉法近似计算不同时刻坐标位置。
<script type="math/tex; mode=display">
\begin{align*}X(t+h)-X(t)&=\int_t^{t+h}f(X(s))ds+\sigma(B(t+h)-B(t))\\&\approx hf(X(t))+\sigma(B(t+h)-B(t))\end{align*}\tag{4.1}
</script>
因此在 <script type="math/tex">t</script> 时刻的位置给定时，可以估计下一时刻的分布：
<script type="math/tex; mode=display">
X(t+h)\sim N(X(t)+hf(X(t)), \sigma^2h)\tag{4.2}
</script>
因此前向欧拉法的迭代过程如下所示，这也被称为随机欧拉方法。
<script type="math/tex; mode=display">
\tilde{X}(ih)=\tilde{X}((i-1)h)+f(\tilde{X}((i-1)h))h+\sigma\sqrt{h}Z_i\tag{4.3}
</script>
</p>
<details class="example">
<summary><strong>Ornstein-Unlenbeck Process</strong></summary>
<p>随机微分方程形式如：<script type="math/tex">d(X(s))=\alpha(\mu-X(s))ds+\sigma dB(s), X(0)=x_0</script>，可以显示求解得：
<script type="math/tex; mode=display">
E[X(t)]=e^{-\alpha t}(x_0-\mu)+\mu
</script>
我们知道 <script type="math/tex">\mu</script> 是不动点，当 <script type="math/tex">\alpha>0</script> 时为稳定不动点，即采样路径最终会趋向于 <script type="math/tex">\mu</script>，在距离 <script type="math/tex">\mu</script> 较远时 <em>drift</em> 起主要作用，在距离 <script type="math/tex">\mu</script> 较近时， <em>fluctuation</em> 起主要作用。</p>
</details>
<details class="example">
<summary><strong>Double-well</strong></summary>
<p>考虑 <em>drift</em> 形式如下式的随机微分方程，显然 <em>drift</em> 包含-1，1两个稳定不动点和0不稳定不动点。
<script type="math/tex; mode=display">
f(x)=x\left(\frac{8}{(1+x^2)^2}-2\right)
</script>
在常微分方程中，不同的初始值最终会确认收敛到不同的不动点。但由于随机微分方程中增加了随机涨落，因此其不仅可能收敛于某个稳定的不动点，还有可能在不同的不动点之间跳跃，取决于涨落的方差。</p>
</details>
<details class="example">
<summary>Non-Lipschitz Case</summary>
<p>考虑 <em>drift</em> 形式如下式的随机微分方程，显然不符合Lipschitz条件，但可以验证解存在。
<script type="math/tex; mode=display">
f(x)=-x^3
</script>
</p>
<p>
<script type="math/tex; mode=display">
X(s)=\frac{x_0}{\sqrt{1+2sx_0^2}}, s>-\frac{1}{2x_0^2}
</script>
</p>
<p>当 <script type="math/tex">s\rightarrow -1/(2x_0^2)</script> 时，<em>drift</em> 的值非常大，即起始位置越大，零时刻越靠近 <script type="math/tex">-1/(2x_0^2)</script>，则初始时刻下降的速度越快，因此收敛速度非常快。</p>
</details>
<h2 id="5-robust-model">5. Robust Model</h2>
<p>数值积分的方法为我们求解随机微分方程提供了近似方法，但还是不够的，我们知道向前欧拉法随着时间的发展误差会越来越大。我们希望真正能从数学上研究随机微分方程的宏观结果，真正意义地解决它。</p>
<p>我们首先考虑 (1.3) 中SDE对应的解 <script type="math/tex">X</script>，如果在 <script type="math/tex">X</script> 的基础上增加变化得到 <script type="math/tex">Y</script>，是否仍保持类似的形式？不妨假设 <script type="math/tex">X(t)=B(t), Y(t)=e^{X(t)}</script>，则经过很短时间 <script type="math/tex">h</script> 后有：
<script type="math/tex; mode=display">
\begin{align*}
Y(t+h)-Y(t)&=\exp\{B(t+h)\}-\exp\{B(t)\}\\&\approx Y(t)(\sqrt{h}Z+hZ^2/2)
\end{align*}\tag{5.1}
</script>
因此可得：
<script type="math/tex; mode=display">
E[Y(t+h)-Y(t)|Y(t)]\approx \frac{Y(t)}{2}h, \text{Var}[Y(t+h)-Y(t)|Y(t)]\approx Y(t)^2h\tag{5.2}
</script>
此时变换结果就和此前随机微分方程的解不同了，其条件方差的结果和当前的位置有关系了，此时微观过程近似可以表示为：
<script type="math/tex; mode=display">
dY(s)=\frac{Y(s)}{2}ds+Y(s)dB(s)\tag{5.3}
</script>
对微观过程积分可以得到：
<script type="math/tex; mode=display">
Y(t)=y_0+\int_0^t\frac{Y(s)}{2}ds+\int_0^tY(s)dB(s)\tag{5.4}
</script>
上面的例子提供了两个启示：其一是为了继续对随机微分方程的建模，我们必须要研究对布朗运动的积分；其二是促使我们构建更鲁棒的模型，能够兼容上面的不同的变换，我们构建如下微观过程：
<script type="math/tex; mode=display">
X(t)=x_0+\int_0^tf(X(s))ds+\int_0^t\sigma(X(s))dB(s)\tag{5.5}
</script>
这个微分方程说明了在不同时刻涨落的幅度不再是恒定的值，而是和当前位置相关的，若涨落的方差为定值，则退化为 (1.1) 的形式。</p>
<h2 id="6-integration-bounded-variation">6. Integration &amp; Bounded Variation</h2>
<p>本小节增加了许多数学推导，通过黎曼积分的定义去计算对布朗运动的积分。(5.5) 要求我们需要合适地定义如下积分：
<script type="math/tex; mode=display">
\int_0^t g(\omega,s)dB(\omega, s)\tag{6.1}
</script>
这种积分称作随机积分。在随机微分方程中，被积函数 <script type="math/tex">g(\omega, s)=\sigma(X(\omega, s))</script>，这种积分难以使用常用的微积分工具处理，有两点原因：</p>
<ul>
<li>积分变量和被积函数都是随机过程，涉及到几乎处处、一致收敛等。</li>
<li>积分变量和被积函数通常是相互独立的，处理相互独立的随机变量是很困难的，因而需要将被积函数限制在特定的函数族中。</li>
</ul>
<p>让我们重新回顾黎曼积分，通过黎曼和的形式构造得到，不妨设区间 <script type="math/tex">[a,b]</script> 的一个分割为 <script type="math/tex">a=t_0\le t_1\le ...\le t_{n-1}\le t_n=b </script>，并且当 <script type="math/tex">n\rightarrow \infty</script> 时，间隔 <script type="math/tex">\sup_i\{\Delta t_i\}\rightarrow 0</script>，则黎曼和形式为：
<script type="math/tex; mode=display">
\sum_{i=1}^n g(s_i)\Delta t_i
</script>
黎曼和可以扩展成黎曼－斯蒂尔杰斯积分，形式如：
<script type="math/tex; mode=display">
\sum_{i=1}^n g(s_i)\Delta F_i,\ \  \Delta F_i=F(t_i)-F(t_{i-1})
</script>
其中 <script type="math/tex">s_i</script> 为区间 <script type="math/tex">(t_{i-1}, t_i)</script> 中任意点，映射 <script type="math/tex">F</script> 为单位映射时，则退化成黎曼积分。若 <script type="math/tex">F</script> 为累积分布函数，则黎曼-斯蒂尔杰斯积分表示为被积函数的期望。</p>
<p>以下我们介绍P次变差的概念，并引入 <strong>Jordan</strong> 定理辅助说明布朗运动作为积分元的特殊性。</p>
<details class="note">
<summary><strong>P-Variation</strong></summary>
<p>构建从映射 <script type="math/tex">F: [a,b]\mapsto R</script>，对于任何常数 <script type="math/tex">p>0</script>，定义p次变差 <script type="math/tex">V^{(p)}[F,a,b]</script> 为：
<script type="math/tex; mode=display">
V^{(p)}[F,a,b]=\lim_{n\rightarrow \infty}V_n^{(p)}[F,a,b]=\lim_{n\rightarrow\infty}\sum_{i=1}^n|\Delta F_i|^p
</script>
<script type="math/tex">V^{(1)}[F,a,b]</script> 称为总变差，<script type="math/tex">V^{(2)}[F,a,b]</script> 称为二次变差。若函数的总变差在闭区间 <script type="math/tex">[a,b]</script> 上是有限的，则称函数是有限变差，记作 <script type="math/tex">f\in V[a,b]</script>。</p>
</details>
<details class="note">
<summary><strong>Lemma 1</strong></summary>
<p>设函数 <script type="math/tex">f:[a,b]\rightarrow R</script>，<script type="math/tex">c</script> 是开区间 <script type="math/tex">(a,b)</script> 上的任意点。则 <script type="math/tex">f\in V[a,b]</script> 和 <script type="math/tex">f\in V[a,c], f\in V[c, b]</script> 等价，且如下等式成立。</p>
<p>
<script type="math/tex; mode=display">
V_a^b(f)=V_a^c(f)+V_c^b(f)
</script>
证明：首先证明必要性，不妨设 <script type="math/tex">\Pi_1</script> 为 <script type="math/tex">[a,c]</script> 上的分割，对 <script type="math/tex">\Pi_1</script> 增加 <script type="math/tex">b</script> 点，可扩展为 <script type="math/tex">[a,b]</script> 上的分割 <script type="math/tex">\Pi</script>，则有：
<script type="math/tex; mode=display">
V_{\Pi}(f)=V_{\Pi_1}+|f(b)-f(c)|\le V_a^b(f)\Rightarrow V_{\Pi_1}\le V_a^b(f)-|f(b)-f(c)|
</script>
即子区间 <script type="math/tex">[a,c]</script> 上的任意分割均有上界，则为有限变差，同理在 <script type="math/tex">[c,b]</script> 上为有限变差。</p>
<p>再证明充分性，不妨设 <script type="math/tex">\Pi</script> 为 <script type="math/tex">[a,b]</script> 上分割，增加点 <script type="math/tex">c</script> 将 <script type="math/tex">\Pi</script> 划分成 <script type="math/tex">[a,c], [c,b]</script> 上的分割 <script type="math/tex">\Pi_1, \Pi_2</script>，则有：
<script type="math/tex; mode=display">
V_{\Pi}(f)=V_{\Pi_1}+V_{\Pi_2}\le V_a^c(f)+V_c^b(f)
</script>
则在 <script type="math/tex">[a,b]</script> 上的任意分割均有上界，则为有限变差。极限保序性可得：<script type="math/tex">V_a^b(f)\le V_a^c(f)+V_c^b(f)</script>。将 <script type="math/tex">[a,c], [c,b]</script> 的分割合并即得到 <script type="math/tex">[a,b]</script> 上的分割，则有：<script type="math/tex">V_a^c(f)+V_c^b(f)\le V_a^b(f)</script>，则等式成立。</p>
</details>
<details class="note">
<summary><strong>Jordan Theorem</strong></summary>
<p>若 <script type="math/tex">F</script> 在区间上是有限变差，则 <script type="math/tex">F</script> 可以表示成两个非降函数 <script type="math/tex">F_1, F_2</script> 的差，从而当 <script type="math/tex">F</script> 作为积分元时，可以拆分成两个黎曼-斯蒂尔杰斯积分的差。
<script type="math/tex; mode=display">
F(s)=F_1(s)-F_2(s), F_1,F_2 \text{ increasing}
</script>
</p>
<p>
<script type="math/tex; mode=display">
\int_a^b g(s)dF(s)=\int_a^b g(s)dF_1(s)-\int_a^b g(s)dF_2(s)
</script>
</p>
<p>证明：构造 <script type="math/tex">v(x)=V_a^x(f)</script>，则构造 <script type="math/tex">f(x)=v(x)-(v(x)-f(x))</script>，以下证明 <script type="math/tex">v(x)</script>，<script type="math/tex">v(x)-f(x)</script> 均为非减函数，对于 <script type="math/tex">x_1<x_2</script>，有：
<script type="math/tex; mode=display">
v(x_2)-v(x_1)=V_{x_1}^{x_2}(f)\ge 0
</script>
</p>
<p>
<script type="math/tex; mode=display">
f(x_2)-f(x_1)\le V_{x_1}^{x_2}(f)=v(x_2)-v(x_1)
</script>
</p>
</details>
<p>如果布朗运动在定义域上是有限变差，那么通过 <strong>Jordan</strong> 定理就可以将其拆分成两个黎曼-斯蒂尔杰斯积分的差，就可以用我们的微积分知识解决！太棒了！我们来验证布朗运动是否是有限变差。</p>
<details class="note" open="open">
<summary><strong>Quadratic Variation</strong></summary>
<p>布朗运动在 <script type="math/tex">[0,t]</script> 区间上的二次变差以概率1等于区间长度 <script type="math/tex">t</script>，即：
<script type="math/tex; mode=display">
\lim_{n\rightarrow \infty}E\left[\left(\sum_{i=1}^n|\Delta B_i|^2-t\right)^2\right]=0
</script>
其中 <script type="math/tex">\Delta B_i=B(\omega, t_i)-B(\omega, t_{i-1})</script>。将式子展开整理，其中 <script type="math/tex">\Delta B_i</script> 项通过高斯分布积分可以表示成 <script type="math/tex">\Delta t_i</script> 的形式，整理得：
<script type="math/tex; mode=display">
E\left[\left(\sum_{i=1}^n|\Delta B_i|^2-t\right)^2\right]=2E\left[\sum_{i=1}^n(\Delta t_i)^2\right]
</script>
随着分割点越来越多，<script type="math/tex">\sum_{i=1}^n(\Delta t_i)^2=\sum_{i=1}^nt_i\Delta t_i-\sum_{i=1}^nt_{i-1}\Delta t_i\rightarrow t^2/2-t^2/2=0</script>，因此结论成立。</p>
</details>
<details class="note" open="open">
<summary><strong>BM is of Unbounded Variation</strong></summary>
<p>如果二次变差非零，说明总变差为无穷大，即函数在区间上不是有限变差。根据p次变差的定义有：
<script type="math/tex; mode=display">
V_n^{(2)}[F,a,b]\le \sup_i|\Delta F_i|\times V_n^{(1)}[F,a,b]
</script>
随着分割点数增大，分割间隔趋于零，因此若总变差有限，则二次变差应该为零，即得证。</p>
</details>
<p>呜呜呜，折腾了半天，发现布朗运动并不是有限变差，也就是我们并不能用传统的黎曼-斯蒂尔杰斯积分方法去计算，那么问题出在哪里？</p>
<p>让我们重新回看黎曼-斯蒂尔杰斯积分，我们是通过黎曼-斯蒂尔杰斯和的形式去定义的，其中涉及到极限的结果应该和分割的选择、函数点的选择无关。以下我们结合例子，看看函数点的选择和结果是否有关。</p>
<details class="example" open="open">
<summary>Example</summary>
<p>考虑如下积分，分别通过两个黎曼-斯蒂尔杰斯和 <script type="math/tex">I_n, J_n</script> 进行估计。
<script type="math/tex; mode=display">
\int_0^tB(\omega,s)dB(\omega, s)
</script>
</p>
<p>
<script type="math/tex; mode=display">
I_n(\omega)=\sum_{i=1}^nB(\omega,t_{i-1})\Delta B_i, \ \ J_n(\omega)=\sum_{i=1}^nB(\omega,t_i)\Delta B_i
</script>
</p>
<p>即两个黎曼和在每个分割区间上分别选取左端点和右端点进行计算，结合上述二次变差我们会发现：
<script type="math/tex; mode=display">
J_n(\omega)-I_n(\omega)=\sum_{i=1}^n(\Delta B_i)^2\rightarrow t
</script>
也就是说，由于布朗运动在很短时间内运动幅度过于剧烈(在 <script type="math/tex">\Delta t</script> 时间内运动到 <script type="math/tex">\sqrt{\Delta t}</script> 的位置，则速度趋于无穷)，导致黎曼和的值即便在分割区间趋于零时依然和选点有关的，可以验证的是：
<script type="math/tex; mode=display">
\lim_{n\rightarrow \infty}E\left[\left(I_n(\omega)-\frac{B(\omega,t)^2}{2}+\frac{t}{2}\right)^2\right]=0
</script>
说明黎曼和的极限趋于 <script type="math/tex">B(\omega,t)^2/2-t/2</script>，对比微积分的 <script type="math/tex">\int_0^tF(s)dF(s)=F(t)^2/2</script>，可以发现随机积分和传统积分的不同。</p>
</details>
<p>通过上述例子，我们发现分割区间的不同选点会导致黎曼和的极限趋于不同的值，那我们能否人为选择某个点，赋予随机微分方程涨落部分的含义呢？以及手动赋予和宏观结果直接的差距是什么呢？由此，我们引入最终节——伊藤积分。</p>
<h2 id="7-itos-formula">7. Ito's Formula</h2>
<p>发</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>